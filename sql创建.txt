create database library;

use library;
//mysql端口统一3306，用户名 root 密码 123
//每人首先只创建自己模块的表
create table if not exists user_type(
	`id` int primary key auto_increment comment '主键id',
	`type_name`	varchar(20) not null comment '类型名称',
	`min_score` int not null	comment '达到该类型所需的最低积分',
	`discount` double not null comment '折扣',
	`status` int not null default 1 comment '是否可用	0为false,1为true,默认插入1',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='用户类型表';

create table if not exists `user`(
	`id` int primary key auto_increment comment '主键id',
	`user_name` varchar(20) not null comment '用户名称',
	`user_phone` varchar(11) not null comment'用户电话',
	`user_email` varchar(20) not null comment'用户邮箱',
	`user_score` int not null default 100	comment'用户积分',
	`user_balance` double	default 0	comment'用户余额',
	`id_card` varchar(19) not null comment '用户身份证',
	`user_birthday` datetime not null comment '用户生日',
	`status` int not null default 1 comment '是否可用	0为false,1为true,默认插入1',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='用户表';


create table if not exists `role`(
	`id` int primary key auto_increment comment '主键id',
	`role_name` varchar(20) not null comment '角色名称',
	`status` int not null default 1 comment '是否可用	0为false,1为true,默认插入1',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='角色表';

create table if not exists `acl_module`(
	`id` int primary key auto_increment comment '主键id',
	`acl_module_name` varchar(20) not null comment '权限模块名称',
	`status` int not null default 1 comment '是否可用	0为false,1为true,默认插入1',
	`seq` int not null comment '默认排序顺序',
	`parent_id` int not null comment '父权限模块id',
	`level` varchar(100) not null	comment '层级',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='权限模块表';

create table if not exists `acl`(
	`id` int primary key auto_increment comment '主键id',
	`acl_name` varchar(20) not null	comment '权限名称',
	`status` int not null default 1 comment '是否可用	0为false,1为true,默认插入1',
	`seq` int not null comment '默认排序顺序',
	`type` int not null comment '权限是什么类型',
	`url` varchar(50) not null comment '权限url',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='权限表';

create table if not exists `role_acl`(
	`id` int primary key auto_increment comment '主键id',
	`acl_id` int not null comment '权限id',
	`role_id` int not null comment '角色id',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='角色权限表';

create table if not exists `role_admin`(
	`id` int primary key auto_increment comment '主键id',
	`role_id` int not null comment '角色id',
	`admin_id` int not null comment '管理员id',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='角色管理员表';

create table if not exists `book_type`(
	`id` int primary key auto_increment comment '主键id',
	`type_name` varchar(20) not null comment '类型名称',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍类型表';

create table if not exists `book_lease_type`(
	`id` int primary key auto_increment comment '主键id',
	`type_name` varchar(20) not null comment '类型名称',
	`score` int not null comment '租借所需积分',
	`discount` double not null comment '租借折扣',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍租借类型（特定时期打折）';

create table if not exists `book_loss_type`(
	`id` int primary key auto_increment comment '主键id',
	`type_name` varchar(20) not null comment '类型名称',
	`score` int	not null comment '扣多少分',
	`price` int	not null comment '扣多少钱',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍损坏类型表';

create table if not exists `book_lease`(
	`id` int primary key auto_increment comment '主键id',
	`book_id`	int	not null comment '图书id',
	`user_id` int not null comment '用户id',
	`book_price` double	not null comment'价格，元/天',
	`status` int not null comment '租借状态',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍租借表';

create table if not exists `book`(
	`id` int primary key auto_increment comment '主键id',
	`book_name` varchar(40)	not null comment '书籍名称',
	`book_code`	varchar(40)	not null comment '书籍编号',
	`author_name` varchar(20)	not null comment '作者名称',
	`price`	double not null comment '单价',
	`press_name` varchar(20) not null comment '出版社名称',
	`book_type_id` int not null comment '书籍类型id',
	`book_lease_id`	int	comment '书籍租借id',
	`book_loss_id` int not null comment '书籍损耗id',
	`book_lease_type` int	comment '书籍租借类型id',
	`book_chco_type` int not null comment '书籍收费方式，0为免费，1为收费，收费规则根据 book_code表',
	`book_space_id` int comment '书籍空间id',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍表';

create table if not exists `book_code`(
	`id` int primary key auto_increment comment '主键id',
	`book_price_min` int comment '范围小值',
	`book_price_max` int comment '范围大值',
	`book_price` double comment '价格，元/天',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='书籍价格参照表';


create table if not exists `admin`(
	`id` int primary key auto_increment comment '主键id',
	`admin_code` varchar(20) not null comment '登录账号',
	`admin_pwd` varchar(20) not null comment '登录密码',
	`admin_name` varchar(20) not null	comment '管理员名称',
	`admin_role` int comment '管理员角色',
	`birthday` int	not null comment '管理员年龄',
	`id_card` varchar(19)	not null comment '管理员身份证',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='管理员表';

create table if not exists `space`(
	`id` int primary key auto_increment comment '主键id',
	`space_name` varchar(20) not null comment '空间名称',
	`parent_id` int	comment '父空间',
	`level` varchar(50)	not null comment '层级',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='空间表';

create table if not exists `log`(
	`id` int primary key auto_increment comment '主键id',
	`type` int not null	comment '日志类型',
	`targetId` int not null	comment '目标主键',
	`old_value`	text comment '旧的值',
	`new_value`	text comment '新的值',
	`operator` varchar(20) not null comment '创建管理员',
	`operate_time` datetime not null default NOW() comment '创建时间',
	`remark` varchar(200)	comment '备注'
)comment='日志表';
